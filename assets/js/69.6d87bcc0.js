(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{395:function(t,s,a){"use strict";a.r(s);var r=a(4),_=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"sql-必知必会题解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sql-必知必会题解"}},[t._v("#")]),t._v(" SQL 必知必会题解")]),t._v(" "),s("blockquote",[s("p",[t._v("地址："),s("a",{attrs:{href:"https://www.nowcoder.com/exam/oj?page=1&tab=SQL%E7%AF%87&topicId=298",target:"_blank",rel:"noopener noreferrer"}},[t._v("牛客网在线编程_SQL篇_SQL必知必会 (nowcoder.com)"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"检索数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索数据"}},[t._v("#")]),t._v(" 检索数据")]),t._v(" "),s("h3",{attrs:{id:"从-customers-表中检索所有的-id"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从-customers-表中检索所有的-id"}},[t._v("#")]),t._v(" 从 Customers 表中检索所有的 ID")]),t._v(" "),s("p",[t._v("现有表 Customers 如下：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("A")])]),t._v(" "),s("tr",[s("td",[t._v("B")])]),t._v(" "),s("tr",[s("td",[t._v("C")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Customers 表中检索所有的 cust_id")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"检索并列出已订购产品的清单"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索并列出已订购产品的清单"}},[t._v("#")]),t._v(" 检索并列出已订购产品的清单⭐️")]),t._v(" "),s("p",[t._v("表 OrderItems 含有非空的列 prod_id 代表商品 id，包含了所有已订购的商品（有些已被订购多次）。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")])]),t._v(" "),s("tr",[s("td",[t._v("a2")])]),t._v(" "),s("tr",[s("td",[t._v("a3")])]),t._v(" "),s("tr",[s("td",[t._v("a4")])]),t._v(" "),s("tr",[s("td",[t._v("a5")])]),t._v(" "),s("tr",[s("td",[t._v("a6")])]),t._v(" "),s("tr",[s("td",[t._v("a7")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，检索并列出所有已订购商品（prod_id）的"),s("strong",[t._v("去重后")]),t._v("的清单。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("distinct")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"检索所有列"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索所有列"}},[t._v("#")]),t._v(" 检索所有列")]),t._v(" "),s("p",[t._v("现在有 Customers 表（表中含有列 cust_id 代表客户 id，cust_name 代表客户姓名）")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("a6")]),t._v(" "),s("td",[t._v("lee")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("【问题】需要编写 SQL 语句，检索所有列。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"排序检索数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#排序检索数据"}},[t._v("#")]),t._v(" 排序检索数据")]),t._v(" "),s("h3",{attrs:{id:"检索顾客名称并且排序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索顾客名称并且排序"}},[t._v("#")]),t._v(" 检索顾客名称并且排序")]),t._v(" "),s("p",[t._v("有表 Customers，cust_id 代表客户 id，cust_name 代表客户姓名。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("a6")]),t._v(" "),s("td",[t._v("lee")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("【问题】从 Customers 中检索所有的顾客名称（cust_name），并按从 Z 到 A 的顺序显示结果。(其实就是降序)")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"对顾客-id-和日期排序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#对顾客-id-和日期排序"}},[t._v("#")]),t._v(" 对顾客 ID 和日期排序")]),t._v(" "),s("p",[t._v("有 Orders 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("order_date")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("andy")]),t._v(" "),s("td",[t._v("aaaa")]),t._v(" "),s("td",[t._v("2021-01-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("andy")]),t._v(" "),s("td",[t._v("bbbb")]),t._v(" "),s("td",[t._v("2021-01-01 12:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("bob")]),t._v(" "),s("td",[t._v("cccc")]),t._v(" "),s("td",[t._v("2021-01-10 12:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("dick")]),t._v(" "),s("td",[t._v("dddd")]),t._v(" "),s("td",[t._v("2021-01-11 00:00:00")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Orders 表中检索顾客 ID（cust_id）和订单号（order_num），并先按顾客 ID 对结果进行排序，再按订单日期倒序排列。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_num "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"按照数量和价格排序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#按照数量和价格排序"}},[t._v("#")]),t._v(" 按照数量和价格排序⭐️")]),t._v(" "),s("p",[t._v("假设有一个 OrderItems 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("quantity")]),t._v(" "),s("th",[t._v("item_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("1")]),t._v(" "),s("td",[t._v("100")])]),t._v(" "),s("tr",[s("td",[t._v("10")]),t._v(" "),s("td",[t._v("1003")])]),t._v(" "),s("tr",[s("td",[t._v("2")]),t._v(" "),s("td",[t._v("500")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，显示 OrderItems 表中的数量（quantity）和价格（item_price），并按数量由多到少、价格由高到低排序。")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" item_price "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" quantity "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("item_price "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"检查-sql-语句"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检查-sql-语句"}},[t._v("#")]),t._v(" 检查 SQL 语句")]),t._v(" "),s("p",[t._v("有 Vendors 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("海底捞")])]),t._v(" "),s("tr",[s("td",[t._v("小龙坎")])]),t._v(" "),s("tr",[s("td",[t._v("大龙燚")])])])]),t._v(" "),s("p",[t._v("【问题】下面的 SQL 语句有问题吗？尝试将它改正确，使之能够正确运行，并且返回结果根据 vend_name 逆序排列")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" vend_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Vendors \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" vend_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("答案：少了个 "),s("code",[t._v("by")])]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" vend_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Vendors "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" vend_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h2",{attrs:{id:"过滤数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#过滤数据"}},[t._v("#")]),t._v(" 过滤数据")]),t._v(" "),s("h3",{attrs:{id:"返回固定价格的产品"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回固定价格的产品"}},[t._v("#")]),t._v(" 返回固定价格的产品")]),t._v(" "),s("p",[t._v("有表 Products")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0018")]),t._v(" "),s("td",[t._v("sockets")]),t._v(" "),s("td",[t._v("9.49")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("iphone13")]),t._v(" "),s("td",[t._v("600")])]),t._v(" "),s("tr",[s("td",[t._v("b0018")]),t._v(" "),s("td",[t._v("gucci t-shirts")]),t._v(" "),s("td",[t._v("1000")])])])]),t._v(" "),s("p",[t._v("【问题】从 Products 表中检索产品 ID（prod_id）和产品名称（prod_name），只返回价格为 9.49 美元的产品。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9.49")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"返回更高价格的产品"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回更高价格的产品"}},[t._v("#")]),t._v(" 返回更高价格的产品")]),t._v(" "),s("p",[t._v("Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0018")]),t._v(" "),s("td",[t._v("sockets")]),t._v(" "),s("td",[t._v("9.49")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("iphone13")]),t._v(" "),s("td",[t._v("600")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("gucci t-shirts")]),t._v(" "),s("td",[t._v("1000")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Products 表中检索产品 ID（prod_id）和产品名称（prod_name），只返回价格为 9 美元或更高的产品。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("h3",{attrs:{id:"返回产品并且按照价格排序"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回产品并且按照价格排序"}},[t._v("#")]),t._v(" 返回产品并且按照价格排序⭐️")]),t._v(" "),s("p",[t._v("有 Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("egg")]),t._v(" "),s("td",[t._v("3")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("sockets")]),t._v(" "),s("td",[t._v("4")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("coffee")]),t._v(" "),s("td",[t._v("15")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回 Products 表中所有价格在 3 美元到 6 美元之间的产品的名称（prod_name）和价格（prod_price），然后按价格对结果进行排序")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_price\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("BETWEEN")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" prod_price\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_price\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" prod_price\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h3",{attrs:{id:"返回更多的产品"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回更多的产品"}},[t._v("#")]),t._v(" 返回更多的产品⭐️")]),t._v(" "),s("p",[t._v("OrderItems 表含有：订单号 order_num，quantity 产品数量")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("【问题】从 OrderItems 表中检索出所有"),s("strong",[t._v("不同且不重复")]),t._v("的订单号（order_num），其中每个订单都要包含 100 个或更多的产品。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("SUM")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("group by")]),t._v(": 字段进行分组可以实现不同且不重复的结果。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("HAVING")]),t._v(" 子句：用于过滤分组后的结果，只返回满足条件的分组，这里是筛选满足 "),s("code",[t._v("SUM(quantity) >= 100")]),t._v(" 条件的分组。")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("SUM()")]),t._v(" 函数：用于计算指定字段的总和，这里是计算 quantity 字段的总和。")])])]),t._v(" "),s("h2",{attrs:{id:"高级数据过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高级数据过滤"}},[t._v("#")]),t._v(" 高级数据过滤")]),t._v(" "),s("h3",{attrs:{id:"检索供应商名称"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索供应商名称"}},[t._v("#")]),t._v(" 检索供应商名称")]),t._v(" "),s("p",[t._v("Vendors 表有字段供应商名称（vend_name）、供应商国家（vend_country）、供应商州（vend_state）")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_name")]),t._v(" "),s("th",[t._v("vend_country")]),t._v(" "),s("th",[t._v("vend_state")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("apple")]),t._v(" "),s("td",[t._v("USA")]),t._v(" "),s("td",[t._v("CA")])]),t._v(" "),s("tr",[s("td",[t._v("vivo")]),t._v(" "),s("td",[t._v("CNA")]),t._v(" "),s("td",[t._v("shenzhen")])]),t._v(" "),s("tr",[s("td",[t._v("huawei")]),t._v(" "),s("td",[t._v("CNA")]),t._v(" "),s("td",[t._v("xian")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Vendors 表中检索供应商名称（vend_name），仅返回加利福尼亚州的供应商（这需要按国家[USA]和州[CA]进行过滤，没准其他国家也存在一个[CA]）")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" vend_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Vendors "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" vend_country "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'USA'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" vend_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CA'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("注意：")]),t._v(" "),s("ul",[s("li",[t._v("字符串需要使用 "),s("code",[t._v("单引号")]),t._v(" 或 "),s("code",[t._v("双引号")]),t._v(" 包裹")])]),t._v(" "),s("h3",{attrs:{id:"检索并列出已订购产品的清单-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索并列出已订购产品的清单-2"}},[t._v("#")]),t._v(" 检索并列出已订购产品的清单⭐️")]),t._v(" "),s("p",[t._v("OrderItems 表包含了所有已订购的产品（有些已被订购多次）。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("BR03")]),t._v(" "),s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("BR017")]),t._v(" "),s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("BR017")]),t._v(" "),s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，查找所有订购了数量至少 100 个的 BR01、BR02 或BR03 的订单。你需要返回 OrderItems 表的订单号（order_num）、产品 ID（prod_id）和数量（quantity），并按产品 ID 和数量进行过滤。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" quantity \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR02'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR03'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" quantity "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"返回所有价格在-3-美元到-6-美元之间的产品的名称和价格"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回所有价格在-3-美元到-6-美元之间的产品的名称和价格"}},[t._v("#")]),t._v(" 返回所有价格在 3 美元到 6 美元之间的产品的名称和价格")]),t._v(" "),s("p",[t._v("有表 Products")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("egg")]),t._v(" "),s("td",[t._v("3")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("sockets")]),t._v(" "),s("td",[t._v("4")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("coffee")]),t._v(" "),s("td",[t._v("15")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回所有价格在 3 美元到 6 美元之间的产品的名称（prod_name）和价格（prod_price），使用 AND 操作符，然后按价格对结果进行升序排序")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_price \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("between")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("6")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("asc")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"纠错-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#纠错-2"}},[t._v("#")]),t._v(" 纠错 2")]),t._v(" "),s("p",[t._v("供应商表 Vendors 有字段供应商名称 vend_name、供应商国家 vend_country、供应商省份 vend_state")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_name")]),t._v(" "),s("th",[t._v("vend_country")]),t._v(" "),s("th",[t._v("vend_state")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("apple")]),t._v(" "),s("td",[t._v("USA")]),t._v(" "),s("td",[t._v("CA")])]),t._v(" "),s("tr",[s("td",[t._v("vivo")]),t._v(" "),s("td",[t._v("CNA")]),t._v(" "),s("td",[t._v("shenzhen")])]),t._v(" "),s("tr",[s("td",[t._v("huawei")]),t._v(" "),s("td",[t._v("CNA")]),t._v(" "),s("td",[t._v("xian")])])])]),t._v(" "),s("p",[t._v("【问题】修改正确下面 sql，使之正确返回")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" vend_name \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Vendors \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" vend_name\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" vend_country "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'USA'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" vend_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CA'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" vend_name \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Vendors \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" vend_country "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'USA'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" vend_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'CA'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" vend_name \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("知识点：考察 sql 关键词的顺序。")]),t._v(" "),s("p",[s("code",[t._v("order by")]),t._v(" 的位置位于所有语句的倒数第二，倒数第一是 "),s("code",[t._v("limit")])]),t._v(" "),s("h2",{attrs:{id:"用通配符进行过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#用通配符进行过滤"}},[t._v("#")]),t._v(" 用通配符进行过滤")]),t._v(" "),s("p",[t._v("SQL 通配符必须与 "),s("code",[t._v("LIKE")]),t._v(" 运算符一起使用")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("通配符")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("%")]),t._v(" "),s("td",[t._v("用于表示零个或多个字符，可以匹配任意长度的字符串。例如，'abc%' 可以匹配 'abc'、'abcd'、'abcxyz' 等。")])]),t._v(" "),s("tr",[s("td",[t._v("_")]),t._v(" "),s("td",[t._v("用于表示单个字符，可以匹配任意单个字符。例如，'a_c' 可以匹配 'abc'、'adc'、'axc' 等，但不能匹配 'abcd'、'abcde' 等。")])]),t._v(" "),s("tr",[s("td",[t._v("[ ]")]),t._v(" "),s("td",[t._v("用于表示"),s("strong",[t._v("字符范围")]),t._v("，可以匹配指定范围内的任意一个字符。例如，'[a-z]' 可以匹配任意小写字母。")])]),t._v(" "),s("tr",[s("td",[t._v("[^ ]")]),t._v(" "),s("td",[t._v("用于表示字符集的补集，可以匹配不在指定字符集中的任意一个字符。例如，"),s("code",[t._v("'[^aeiou]'")]),t._v(" 可以匹配任意非元音字母。")])])])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("[^abc]")]),t._v("：表示匹配除了 a、b、c 以外的任意一个字符。")]),t._v(" "),s("li",[s("code",[t._v("[^a-z]")]),t._v("：表示匹配除了小写字母a到z以外的任意一个字符。")]),t._v(" "),s("li",[s("code",[t._v("[^0-9]")]),t._v("：表示匹配除了数字0到9以外的任意一个字符。")]),t._v(" "),s("li",[s("code",[t._v("[^aeiou]")]),t._v("：表示匹配除了元音字母 a、e、i、o、u 以外的任意一个字母。")])]),t._v(" "),s("h3",{attrs:{id:"检索产品名称和描述-一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索产品名称和描述-一"}},[t._v("#")]),t._v(" 检索产品名称和描述（一）⭐️")]),t._v(" "),s("p",[t._v("Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_desc")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("usb")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("iphone13")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("gucci t-shirts")])]),t._v(" "),s("tr",[s("td",[t._v("c0019")]),t._v(" "),s("td",[t._v("gucci toy")])]),t._v(" "),s("tr",[s("td",[t._v("d0019")]),t._v(" "),s("td",[t._v("lego toy")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回描述中包含 toy 一词的产品名称")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_desc \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_desc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%toy%'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"检索产品名称和描述-二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索产品名称和描述-二"}},[t._v("#")]),t._v(" 检索产品名称和描述（二）⭐️")]),t._v(" "),s("p",[t._v("Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_desc")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("usb")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("iphone13")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("gucci t-shirts")])]),t._v(" "),s("tr",[s("td",[t._v("c0019")]),t._v(" "),s("td",[t._v("gucci toy")])]),t._v(" "),s("tr",[s("td",[t._v("d0019")]),t._v(" "),s("td",[t._v("lego toy")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回描述中未出现 toy 一词的产品，最后按【产品名称】对结果进行排序（"),s("strong",[t._v("默认升序")]),t._v("）。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_desc \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_desc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("not")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%toy%'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" prod_name\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("not like")]),t._v(" 不包含")])]),t._v(" "),s("h3",{attrs:{id:"检索产品名称和描述-三"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索产品名称和描述-三"}},[t._v("#")]),t._v(" 检索产品名称和描述（三）⭐️")]),t._v(" "),s("p",[t._v("Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_desc")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("usb")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("iphone13")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("gucci t-shirts")])]),t._v(" "),s("tr",[s("td",[t._v("c0019")]),t._v(" "),s("td",[t._v("gucci toy")])]),t._v(" "),s("tr",[s("td",[t._v("d0019")]),t._v(" "),s("td",[t._v("lego carrots toy")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回描述中同时出现 toy 和 carrots 的产品。有好几种方法可以执行此操作，但对于这个挑战题，请使用 AND 和两个 LIKE 比较。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_desc \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# where prod_desc like '%carrots%toy%'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_desc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%toy%'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" prod_desc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%carrots%'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("注意："),s("code",[t._v("and")]),t._v(" 的两边都要写上字段名")]),t._v(" "),s("h3",{attrs:{id:"检索产品名称和描述-四"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索产品名称和描述-四"}},[t._v("#")]),t._v(" 检索产品名称和描述（四）")]),t._v(" "),s("p",[t._v("Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_name")]),t._v(" "),s("th",[t._v("prod_desc")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("usb")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("iphone13")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("gucci t-shirts")])]),t._v(" "),s("tr",[s("td",[t._v("c0019")]),t._v(" "),s("td",[t._v("gucci toy")])]),t._v(" "),s("tr",[s("td",[t._v("d0019")]),t._v(" "),s("td",[t._v("lego toy carrots")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Products 表中检索产品名称（prod_name）和描述（prod_desc），仅返回在描述中以"),s("strong",[t._v("先后顺序")]),t._v("同时出现 toy 和 carrots 的产品。提示：只需要用带有三个 % 符号的 LIKE 即可。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_desc \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_desc "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%toy%carrots%'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h2",{attrs:{id:"创建计算字段"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建计算字段"}},[t._v("#")]),t._v(" 创建计算字段")]),t._v(" "),s("h3",{attrs:{id:"别名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#别名"}},[t._v("#")]),t._v(" 别名")]),t._v(" "),s("p",[t._v("别名的常见用法是在检索出的结果中重命名表的列字段（为了符合特定的报表要求或客户需求）。有表 Vendors 代表供应商信息，vend_id 供应商 id、vend_name 供应商名称、vend_address 供应商地址、vend_city 供应商城市。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_id")]),t._v(" "),s("th",[t._v("vend_name")]),t._v(" "),s("th",[t._v("vend_address")]),t._v(" "),s("th",[t._v("vend_city")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a001")]),t._v(" "),s("td",[t._v("tencent cloud")]),t._v(" "),s("td",[t._v("address1")]),t._v(" "),s("td",[t._v("shenzhen")])]),t._v(" "),s("tr",[s("td",[t._v("a002")]),t._v(" "),s("td",[t._v("huawei cloud")]),t._v(" "),s("td",[t._v("address2")]),t._v(" "),s("td",[t._v("dongguan")])]),t._v(" "),s("tr",[s("td",[t._v("a003")]),t._v(" "),s("td",[t._v("aliyun cloud")]),t._v(" "),s("td",[t._v("address3")]),t._v(" "),s("td",[t._v("hangzhou")])]),t._v(" "),s("tr",[s("td",[t._v("a003")]),t._v(" "),s("td",[t._v("netease cloud")]),t._v(" "),s("td",[t._v("address4")]),t._v(" "),s("td",[t._v("guangzhou")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Vendors 表中检索 vend_id、vend_name、vend_address 和 vend_city，将 vend_name 重命名为 vname，将 vend_city 重命名为 vcity，将 vend_address 重命名为 vaddress，按供应商名称对结果进行升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" vend_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vend_name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vend_address "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vaddress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vend_city "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" vcity\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Vendors\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" vname\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# as 可以省略")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" vend_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vend_name vname"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vend_address vaddress"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vend_city vcity\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Vendors\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" vname\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("h3",{attrs:{id:"打折"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#打折"}},[t._v("#")]),t._v(" 打折⭐️")]),t._v(" "),s("p",[t._v("我们的示例商店正在进行打折促销，所有产品均降价 10%。Products 表包含 prod_id 产品 id、prod_price 产品价格")]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，从 Products 表中返回 prod_id、prod_price 和 sale_price。sale_price 是一个包含促销价格的计算字段。提示：可以乘以 0.9，得到原价的 90%（即 10% 的折扣）")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" sale_price\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h2",{attrs:{id:"使用函数处理数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用函数处理数据"}},[t._v("#")]),t._v(" 使用函数处理数据")]),t._v(" "),s("h3",{attrs:{id:"顾客登录名"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#顾客登录名"}},[t._v("#")]),t._v(" 顾客登录名⭐️")]),t._v(" "),s("p",[t._v("我们的商店已经上线了，正在创建顾客账户。所有用户都需要登录名，默认登录名是其名称和所在城市的组合。")]),t._v(" "),s("p",[t._v("给出 Customers 表如下：")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")]),t._v(" "),s("th",[t._v("cust_contact")]),t._v(" "),s("th",[t._v("cust_city")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("Andy Li")]),t._v(" "),s("td",[t._v("Andy Li")]),t._v(" "),s("td",[t._v("Oak Park")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("Ben Liu")]),t._v(" "),s("td",[t._v("Ben Liu")]),t._v(" "),s("td",[t._v("Oak Park")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("Tony Dai")]),t._v(" "),s("td",[t._v("Tony Dai")]),t._v(" "),s("td",[t._v("Oak Park")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("Tom Chen")]),t._v(" "),s("td",[t._v("Tom Chen")]),t._v(" "),s("td",[t._v("Oak Park")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("An Li")]),t._v(" "),s("td",[t._v("An Li")]),t._v(" "),s("td",[t._v("Oak Park")])]),t._v(" "),s("tr",[s("td",[t._v("a6")]),t._v(" "),s("td",[t._v("Lee Chen")]),t._v(" "),s("td",[t._v("Lee Chen")]),t._v(" "),s("td",[t._v("Oak Park")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("Hex Liu")]),t._v(" "),s("td",[t._v("Hex Liu")]),t._v(" "),s("td",[t._v("Oak Park")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回顾客 ID（cust_id）、顾客名称（cust_name）和登录名（user_login），其中登录名全部为大写字母，并由顾客联系人的前两个字符（cust_contact）和其所在城市的前三个字符（cust_city）组成。提示：需要使用函数、拼接和别名。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" upper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("concat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("substring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cust_contact"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" substring"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cust_city"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" user_login\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("p",[t._v("关键词：substing,concat,upper")]),t._v(" "),s("p",[t._v("用法：")]),t._v(" "),s("ul",[s("li",[t._v("字符串的截取：substring(字符串，起始位置，截取字符数）")]),t._v(" "),s("li",[t._v("字符串的拼接：concat(字符串1，字符串2，字符串3,...)")]),t._v(" "),s("li",[t._v("字母大写：upper(字符串）")])]),t._v(" "),s("h3",{attrs:{id:"返回-2020-年-1-月的所有订单的订单号和订单日期"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回-2020-年-1-月的所有订单的订单号和订单日期"}},[t._v("#")]),t._v(" 返回 2020 年 1 月的所有订单的订单号和订单日期⭐️")]),t._v(" "),s("p",[t._v("Orders 订单表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("order_date")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("2020-01-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("2020-01-02 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("2020-01-01 12:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0004")]),t._v(" "),s("td",[t._v("2020-02-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0005")]),t._v(" "),s("td",[t._v("2020-03-01 00:00:00")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回 2020 年 1 月的所有订单的订单号（order_num）和订单日期（order_date），并按订单日期升序排序")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("month")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'01'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("year")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cmty256.github.io/pages/ed0fa0/#%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[t._v("SQL语法基础小结 | 日期和时间处理"),s("OutboundLink")],1)]),t._v(" "),s("blockquote",[s("p",[t._v("其他解法")])]),t._v(" "),s("p",[s("em",[t._v("字符串匹配")]),t._v("（近似查找法）")]),t._v(" "),s("p",[t._v("用 like 来查找")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_date "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020-01%'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("切割字符串")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("7")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020-01'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("字符串比较")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_date "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020-01-01 00:00:00'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" order_date "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020-01-31 23:59:59'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("用正则来查找（效率不如 like，能用 like 就用 like）")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_date "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("regexp")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020-01'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[s("em",[t._v("时间函数匹配")])]),t._v(" "),s("p",[t._v("利用"),s("a",{attrs:{href:"https://www.w3school.com.cn/sql/func_date_format.asp",target:"_blank",rel:"noopener noreferrer"}},[t._v("date_format"),s("OutboundLink")],1),t._v("函数 （参考其中的匹配规则进行匹配）")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" date_format"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_date"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'%Y-%m'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'2020-01'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h2",{attrs:{id:"汇总数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#汇总数据"}},[t._v("#")]),t._v(" 汇总数据")]),t._v(" "),s("h3",{attrs:{id:"确定已售出产品的总数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#确定已售出产品的总数"}},[t._v("#")]),t._v(" 确定已售出产品的总数")]),t._v(" "),s("p",[t._v("OrderItems 表代表售出的产品，quantity 代表售出商品数量。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("100")])]),t._v(" "),s("tr",[s("td",[t._v("1000")])]),t._v(" "),s("tr",[s("td",[t._v("10001")])]),t._v(" "),s("tr",[s("td",[t._v("2")])]),t._v(" "),s("tr",[s("td",[t._v("15")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，确定已售出产品的总数。返回 "),s("code",[t._v("items_ordered")]),t._v(" 列名，表示已售出商品的总数。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" items_ordered\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"确定已售出产品项-br01-的总数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#确定已售出产品项-br01-的总数"}},[t._v("#")]),t._v(" 确定已售出产品项 BR01 的总数")]),t._v(" "),s("p",[t._v("OrderItems 表代表售出的产品，quantity 代表售出商品数量，产品项为 prod_item。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("quantity")]),t._v(" "),s("th",[t._v("prod_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("10")]),t._v(" "),s("td",[t._v("AR01")])]),t._v(" "),s("tr",[s("td",[t._v("100")]),t._v(" "),s("td",[t._v("AR10")])]),t._v(" "),s("tr",[s("td",[t._v("1000")]),t._v(" "),s("td",[t._v("BR01")])]),t._v(" "),s("tr",[s("td",[t._v("10001")]),t._v(" "),s("td",[t._v("BR010")])])])]),t._v(" "),s("p",[t._v('【问题】修改创建的语句，确定已售出产品项（prod_item）为 "BR01" 的总数。')]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" items_ordered\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"确定-products-表中价格不超过-10-美元的最贵产品的价格"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#确定-products-表中价格不超过-10-美元的最贵产品的价格"}},[t._v("#")]),t._v(" 确定 Products 表中价格不超过 10 美元的最贵产品的价格")]),t._v(" "),s("p",[t._v("Products 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("9.49")])]),t._v(" "),s("tr",[s("td",[t._v("600")])]),t._v(" "),s("tr",[s("td",[t._v("1000")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，确定 Products 表中价格不超过 10 美元的最贵产品的价格（prod_price）。将计算所得的字段命名为 max_price。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("max")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prod_price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" max_price\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h2",{attrs:{id:"分组数据"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分组数据"}},[t._v("#")]),t._v(" 分组数据")]),t._v(" "),s("p",[s("code",[t._v("GROUP BY")]),t._v("：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("GROUP BY")]),t._v(" 子句将记录分组到汇总行中。")]),t._v(" "),s("li",[s("code",[t._v("GROUP BY")]),t._v(" 为每个组返回一个记录。")]),t._v(" "),s("li",[s("code",[t._v("GROUP BY")]),t._v(" 通常还涉及聚合"),s("code",[t._v("COUNT")]),t._v("，"),s("code",[t._v("MAX")]),t._v("，"),s("code",[t._v("SUM")]),t._v("，"),s("code",[t._v("AVG")]),t._v(" 等。")]),t._v(" "),s("li",[s("code",[t._v("GROUP BY")]),t._v(" 可以按一列或多列进行分组。")]),t._v(" "),s("li",[s("code",[t._v("GROUP BY")]),t._v(" 按分组字段进行排序后，"),s("code",[t._v("ORDER BY")]),t._v(" 可以以汇总字段来进行排序。")])]),t._v(" "),s("p",[s("code",[t._v("HAVING")]),t._v("：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("HAVING")]),t._v(" 用于对汇总的 "),s("code",[t._v("GROUP BY")]),t._v(" 结果进行过滤。")]),t._v(" "),s("li",[s("code",[t._v("HAVING")]),t._v(" 必须要与 "),s("code",[t._v("GROUP BY")]),t._v(" 连用。")]),t._v(" "),s("li",[s("code",[t._v("WHERE")]),t._v(" 和 "),s("code",[t._v("HAVING")]),t._v(" 可以在相同的查询中。")])]),t._v(" "),s("p",[s("code",[t._v("HAVING")]),t._v(" vs "),s("code",[t._v("WHERE")]),t._v("：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("WHERE")]),t._v("：过滤指定的行，后面不能加聚合函数（分组函数）。")]),t._v(" "),s("li",[s("code",[t._v("HAVING")]),t._v("：过滤分组，必须要与 "),s("code",[t._v("GROUP BY")]),t._v(" 连用，不能单独使用。")])]),t._v(" "),s("h3",{attrs:{id:"返回每个订单号各有多少行数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回每个订单号各有多少行数"}},[t._v("#")]),t._v(" 返回每个订单号各有多少行数")]),t._v(" "),s("p",[t._v("OrderItems 表包含每个订单的每个产品")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a002")])]),t._v(" "),s("tr",[s("td",[t._v("a002")])]),t._v(" "),s("tr",[s("td",[t._v("a002")])]),t._v(" "),s("tr",[s("td",[t._v("a004")])]),t._v(" "),s("tr",[s("td",[t._v("a007")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回每个订单号（order_num）各有多少行数（order_lines），并按 order_lines 对结果进行升序排序。")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" order_lines\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_lines\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[s("code",[t._v("count(*)")]),t._v(","),s("code",[t._v("count(列名)")]),t._v(" 都可以，区别在于："),s("code",[t._v("count(列名)")]),t._v(" 是统计非 NULL 的行数；")]),t._v(" "),s("h3",{attrs:{id:"每个供应商成本最低的产品"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#每个供应商成本最低的产品"}},[t._v("#")]),t._v(" 每个供应商成本最低的产品")]),t._v(" "),s("p",[t._v("有 Products 表，含有字段 prod_price 代表产品价格，vend_id 代表供应商 id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_id")]),t._v(" "),s("th",[t._v("prod_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0011")]),t._v(" "),s("td",[t._v("100")])]),t._v(" "),s("tr",[s("td",[t._v("a0019")]),t._v(" "),s("td",[t._v("0.1")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("1000")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("6980")])]),t._v(" "),s("tr",[s("td",[t._v("b0019")]),t._v(" "),s("td",[t._v("20")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回名为 cheapest_item 的字段，该字段包含每个供应商成本最低的产品（使用 Products 表中的 prod_price），然后从最低成本到最高成本对结果进行升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" vend_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("min")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prod_price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cheapest_item \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" vend_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cheapest_item\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"返回订单数量总和不小于-100-的所有订单的订单号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回订单数量总和不小于-100-的所有订单的订单号"}},[t._v("#")]),t._v(" 返回订单数量总和不小于 100 的所有订单的订单号")]),t._v(" "),s("p",[t._v("OrderItems 代表订单商品表，包括：订单号 order_num 和订单数量 quantity。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("【问题】请编写 SQL 语句，返回订单数量总和不小于 100 的所有订单号，最后结果按照订单号升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("having")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h3",{attrs:{id:"计算总和"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#计算总和"}},[t._v("#")]),t._v(" 计算总和")]),t._v(" "),s("p",[t._v("OrderItems 表代表订单信息，包括字段：订单号 order_num 和 item_price 商品售出价格、 quantity 商品数量。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("item_price")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("10")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("5")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("7")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，根据订单号聚合，返回订单总价不小于 1000 的所有订单号，最后的结果按订单号进行升序排序。")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_priceice\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("having")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h3",{attrs:{id:"纠错-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#纠错-3"}},[t._v("#")]),t._v(" 纠错 3⭐️")]),t._v(" "),s("p",[t._v("OrderItems 表含有 order_num 订单号")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a002")])]),t._v(" "),s("tr",[s("td",[t._v("a002")])]),t._v(" "),s("tr",[s("td",[t._v("a002")])]),t._v(" "),s("tr",[s("td",[t._v("a004")])]),t._v(" "),s("tr",[s("td",[t._v("a007")])])])]),t._v(" "),s("p",[t._v("【问题】将下面代码修改正确后执行")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" items \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" OrderItems \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" items \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("COUNT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" items \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" OrderItems \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" order_num \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HAVING COUNT(*) >= 3 这个也可")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("HAVING")]),t._v(" items "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" items"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[s("em",[t._v("知识点：执行顺序问题，别名的使用规则")])]),t._v(" "),s("ol",[s("li",[t._v("SQL 查询的执行顺序是先执行 "),s("code",[t._v("FROM")]),t._v("、"),s("code",[t._v("WHERE")]),t._v("、"),s("code",[t._v("GROUP BY")]),t._v("、"),s("code",[t._v("HAVING")]),t._v(" 和最后是 "),s("code",[t._v("SELECT")]),t._v("。")])]),t._v(" "),s("p",[s("code",[t._v("SELECT order_num, COUNT(*) AS items FROM OrderItems GROUP BY order_num HAVING items >= 3 ORDER BY items, order_num;")]),t._v(" 这个使用别名不报错；")]),t._v(" "),s("p",[s("code",[t._v("select order_num, sum(item_price * quantity) as total_price from OrderItems group by order_num having total_price >= 1000 order by order_num")]),t._v(" 但为什么这个使用别名就会报错")]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[t._v("在 SQL 查询中，使用别名通常分为两种情况：")])]),t._v(" "),s("ul",[s("li",[t._v("使用别名在 "),s("code",[t._v("SELECT")]),t._v(" 子句中展示"),s("strong",[t._v("计算结果")]),t._v("：这种情况下，别名可以直接在其他子句中使用，如在 "),s("code",[t._v("GROUP BY")]),t._v("、"),s("code",[t._v("HAVING")]),t._v("、"),s("code",[t._v("ORDER BY")]),t._v(" 等子句中使用别名进行条件过滤或排序。这就是为什么你的第一个查询中使用别名 "),s("code",[t._v("items")]),t._v(" 在 "),s("code",[t._v("HAVING")]),t._v(" 子句中不会报错的原因。")]),t._v(" "),s("li",[t._v("使用别名在 "),s("code",[t._v("HAVING")]),t._v(" 子句中进行"),s("strong",[t._v("条件过滤")]),t._v("：这种情况下，数据库管理系统不会识别别名，因为 "),s("code",[t._v("HAVING")]),t._v(" 子句是在 "),s("code",[t._v("GROUP BY")]),t._v(" 子句之后执行的，此时数据库还没有计算别名对应的结果。所以在 "),s("code",[t._v("HAVING")]),t._v(" 子句中使用别名进行条件过滤是会报错的。")])]),t._v(" "),s("h2",{attrs:{id:"使用子查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用子查询"}},[t._v("#")]),t._v(" 使用子查询")]),t._v(" "),s("h3",{attrs:{id:"返回购买价格为-10-美元或以上产品的顾客列表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回购买价格为-10-美元或以上产品的顾客列表"}},[t._v("#")]),t._v(" 返回购买价格为 10 美元或以上产品的顾客列表")]),t._v(" "),s("p",[t._v("OrderItems 表示订单商品表，含有字段订单号：order_num、订单价格：item_price；Orders表代表订单信息表，含有顾客id：cust_id 和订单号：order_num")]),t._v(" "),s("p",[t._v("OrderItems 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("item_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("2")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("5")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("7")])])])]),t._v(" "),s("p",[t._v("Orders 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("cust2")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("cust5")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("cust7")])])])]),t._v(" "),s("p",[t._v("【问题】使用子查询，返回购买价格为 10 美元或以上产品的顾客列表，结果无需排序。\n注意：你需要使用 OrderItems 表查找匹配的订单号（order_num），然后使用 Order 表检索这些匹配订单的顾客 ID（cust_id）。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("having")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item_price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h3",{attrs:{id:"确定哪些订单购买了-prod-id-为-br01-的产品-一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#确定哪些订单购买了-prod-id-为-br01-的产品-一"}},[t._v("#")]),t._v(" 确定哪些订单购买了 prod_id 为 BR01 的产品（一）")]),t._v(" "),s("p",[t._v("表 OrderItems 代表订单商品信息表，prod_id 为产品 id；Orders 表代表订单表有 cust_id 代表顾客 id 和订单日期 order_date")]),t._v(" "),s("p",[t._v("OrderItems 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0001")])]),t._v(" "),s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0002")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0003")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0013")])])])]),t._v(" "),s("p",[t._v("Orders 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("order_date")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("2022-01-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-01 00:01:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-02 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("2022-01-01 00:20:00")])])])]),t._v(" "),s("p",[t._v("【问题】")]),t._v(" "),s("p",[t._v('编写 SQL 语句，使用子查询来确定哪些订单（在 OrderItems 中）购买了 prod_id 为 "BR01" 的产品，然后从 Orders 表中返回每个产品对应的顾客 ID（cust_id）和订单日期（order_date），按订购日期对结果进行升序排序。')]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h3",{attrs:{id:"返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-一"}},[t._v("#")]),t._v(" 返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件（一）")]),t._v(" "),s("p",[t._v("你想知道订购 BR01 产品的日期，有表 OrderItems 代表订单商品信息表，prod_id 为产品 id；Orders 表代表订单表有 cust_id 代表顾客 id 和订单日期 order_date；Customers 表含有 cust_email 顾客邮件和 cust_id 顾客 id")]),t._v(" "),s("p",[t._v("OrderItems 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0001")])]),t._v(" "),s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0002")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0003")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0013")])])])]),t._v(" "),s("p",[t._v("Orders 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("order_date")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("2022-01-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-01 00:01:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-02 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("2022-01-01 00:20:00")])])])]),t._v(" "),s("p",[t._v("Customers 表代表顾客信息，cust_id 为顾客 id，cust_email 为顾客 email")]),t._v(" "),s("p",[t._v("【问题】返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件（Customers 表中的 cust_email），结果无需排序。")]),t._v(" "),s("p",[t._v("提示：这涉及 SELECT 语句，最内层的从 OrderItems 表返回 order_num，中间的从 Customers 表返回 cust_id。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 1：子查询")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_email\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n                   "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num\n                                       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n                                       "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("                                                                          \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 2: 连接表（inner join）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_email\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" OrderItems a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Orders b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Customers c\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("AND")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 3：连接表（left join）")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_email\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Orders a "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v("\n  OrderItems b "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("LEFT")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("JOIN")]),t._v("\n  Customers c "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ON")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),t._v("                             \n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("h3",{attrs:{id:"返回每个顾客不同订单的总金额"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回每个顾客不同订单的总金额"}},[t._v("#")]),t._v(" 返回每个顾客不同订单的总金额⭐️")]),t._v(" "),s("p",[t._v("我们需要一个顾客 ID 列表，其中包含他们已订购的总金额。")]),t._v(" "),s("p",[t._v("OrderItems 表代表订单信息，OrderItems 表有订单号：order_num 和商品售出价格：item_price、商品数量：quantity。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("item_price")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("10")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("5")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("7")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("Orders 表订单号：order_num、顾客 id：cust_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("cust2")])])])]),t._v(" "),s("p",[t._v("【问题】")]),t._v(" "),s("p",[t._v("编写 SQL 语句，返回顾客 ID（Orders 表中的 cust_id），并使用子查询返回 total_ordered 以便返回每个顾客的订单总数，将结果按金额从大到小排序。")]),t._v(" "),s("p",[t._v("提示：你之前已经使用 SUM() 计算订单总数。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 1：子查询")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("total_ordered "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_ordered\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_ordered\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems \n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Orders  o\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" total_ordered "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 2：连接表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quantity "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("item_price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_ordered\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Orders b\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" b"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" total_ordered "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("desc")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("ul",[s("li",[t._v("隐式内连接用 "),s("code",[t._v("where")])]),t._v(" "),s("li",[t._v("显示内连接用 "),s("code",[t._v("on")])])]),t._v(" "),s("h3",{attrs:{id:"从-products-表中检索所有的产品名称以及对应的销售总数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从-products-表中检索所有的产品名称以及对应的销售总数"}},[t._v("#")]),t._v(" 从 Products 表中检索所有的产品名称以及对应的销售总数")]),t._v(" "),s("p",[t._v("Products 表中检索所有的产品名称：prod_name、产品 id：prod_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("egg")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("sockets")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("coffee")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cola")])])])]),t._v(" "),s("p",[t._v("OrderItems 代表订单商品表，订单产品：prod_id、售出数量：quantity")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("【问题】")]),t._v(" "),s("p",[t._v("编写 SQL 语句，从 Products 表中检索所有的产品名称（prod_name），以及名为 quant_sold 的计算列，其中包含所售产品的总数（在 OrderItems 表上使用子查询和 SUM(quantity) 检索）。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 1：子查询")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quant_sold\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" quant_sold\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" OrderItems\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  Products p\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" tb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 写法 2：连接表")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" quant_sold\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Products p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  OrderItems o\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_name（这里不能用 p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id，会报错）\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br")])]),s("h2",{attrs:{id:"联结表"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#联结表"}},[t._v("#")]),t._v(" 联结表")]),t._v(" "),s("h3",{attrs:{id:"返回顾客名称和相关订单号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回顾客名称和相关订单号"}},[t._v("#")]),t._v(" 返回顾客名称和相关订单号")]),t._v(" "),s("p",[t._v("Customers 表有字段顾客名称cust_name、顾客id cust_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("cust22")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("cust221")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("cust2217")]),t._v(" "),s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("Orders订单信息表，含有字段order_num订单号、cust_id顾客id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("cust2")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("cust22")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("cust221")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("cust2217")])])])]),t._v(" "),s("p",[t._v("【问题】")]),t._v(" "),s("p",[t._v("编写 SQL 语句，返回 Customers 表中的顾客名称（cust_name）和 Orders 表中的相关订单号（order_num），并按顾客名称再按订单号对结果进行升序排序。你可以尝试用两个不同的写法，一个使用简单的等联结语法，另外一个使用 INNER JOIN。")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 方法一")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Orders o\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 方法二：inner join")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers c "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" Orders o\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("on")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("h3",{attrs:{id:"返回顾客名称和相关订单号以及每个订单的总价"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回顾客名称和相关订单号以及每个订单的总价"}},[t._v("#")]),t._v(" 返回顾客名称和相关订单号以及每个订单的总价⭐️")]),t._v(" "),s("p",[t._v("Customers 表有字段，顾客名称：cust_name、顾客 id：cust_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("cust22")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("cust221")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("cust2217")]),t._v(" "),s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("Orders 订单信息表，含有字段，订单号：order_num、顾客 id：cust_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("cust2")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("cust22")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("cust221")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("cust2217")])])])]),t._v(" "),s("p",[t._v("OrderItems 表有字段，商品订单号：order_num、商品数量：quantity、商品价格：item_price")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("quantity")]),t._v(" "),s("th",[t._v("item_price")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("1000")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("200")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("10")]),t._v(" "),s("td",[t._v("15")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("25")]),t._v(" "),s("td",[t._v("50")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("15")]),t._v(" "),s("td",[t._v("25")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("7")]),t._v(" "),s("td",[t._v("7")])])])]),t._v(" "),s("p",[t._v("【问题】除了返回顾客名称和订单号，返回 Customers 表中的顾客名称（cust_name）和 Orders 表中的相关订单号（order_num），添加第三列 OrderTotal，其中包含每个订单的总价，并按顾客名称再按订单号对结果进行升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 等连接语法")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("o2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("quantity "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" o2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("item_price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" OrderTotal\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Orders o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" OrderItems o2\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("and")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" o2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("order_num\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("ul",[s("li",[t._v("分组：通过在 "),s("code",[t._v("GROUP BY")]),t._v(" 子句中使用 "),s("code",[t._v("c.cust_name, o.order_num")]),t._v(" 来指定按 "),s("code",[t._v("Customers")]),t._v(" 表中的 "),s("code",[t._v("cust_name")]),t._v(" 和 "),s("code",[t._v("Orders")]),t._v(" 表中的 "),s("code",[t._v("order_num")]),t._v(" 对查询结果进行分组。这样，查询结果将按照顾客姓名和订单号进行分组，每个分组对应一个顾客的一个订单。（唯一的）")])]),t._v(" "),s("p",[t._v("分组的目的是将具有相同 "),s("code",[t._v("cust_name")]),t._v(" 和 "),s("code",[t._v("order_num")]),t._v(" 字段值的数据行归为一组，并对每个组内的数据进行聚合操作。")]),t._v(" "),s("blockquote",[s("p",[t._v("一句话，select 中的字段要么都聚类，要么都不聚类")])]),t._v(" "),s("p",[s("em",[t._v("是否要分组取决于查询的需求。")])]),t._v(" "),s("p",[t._v("如果不需要对数据进行聚合操作或按照某些字段进行统计计算，那么可以不使用分组。但在这个查询中，由于需要计算每个订单的总金额，所以需要按照 "),s("code",[t._v("cust_name")]),t._v(" 和 "),s("code",[t._v("order_num")]),t._v(" 字段进行分组。如果不使用 "),s("code",[t._v("GROUP BY")]),t._v("，查询结果将会是没有经过聚合计算的所有数据行，而不是按订单进行汇总后的结果。")]),t._v(" "),s("h3",{attrs:{id:"确定哪些订单购买了-prod-id-为-br01-的产品-二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#确定哪些订单购买了-prod-id-为-br01-的产品-二"}},[t._v("#")]),t._v(" 确定哪些订单购买了 prod_id 为 BR01 的产品（二）")]),t._v(" "),s("p",[t._v("表 OrderItems 代表订单商品信息表，prod_id 为产品 id；Orders 表代表订单表有 cust_id 代表顾客 id 和订单日期 order_date")]),t._v(" "),s("p",[t._v("OrderItems 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0001")])]),t._v(" "),s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0002")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0003")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0013")])])])]),t._v(" "),s("p",[t._v("Orders 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("order_date")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("2022-01-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-01 00:01:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-02 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("2022-01-01 00:20:00")])])])]),t._v(" "),s("p",[t._v('【问题】编写 SQL 语句，使用子查询来确定哪些订单（在 OrderItems 中）购买了 prod_id 为 "BR01" 的产品，然后从 Orders 表中返回每个产品对应的顾客 ID（cust_id）和订单日期（order_date），按订购日期对结果进行升序排序。')]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_date\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" order_date\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("h3",{attrs:{id:"返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回购买-prod-id-为-br01-的产品的所有顾客的电子邮件-二"}},[t._v("#")]),t._v(" 返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件（二）")]),t._v(" "),s("p",[t._v("有表 OrderItems 代表订单商品信息表，prod_id 为产品 id；Orders 表代表订单表有 cust_id 代表顾客 id 和订单日期 order_date；Customers 表含有 cust_email 顾客邮件和 cust_id 顾客 id")]),t._v(" "),s("p",[t._v("OrderItems 表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0001")])]),t._v(" "),s("tr",[s("td",[t._v("BR01")]),t._v(" "),s("td",[t._v("a0002")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0003")])]),t._v(" "),s("tr",[s("td",[t._v("BR02")]),t._v(" "),s("td",[t._v("a0013")])])])]),t._v(" "),s("p",[t._v("Orders表")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("order_date")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("2022-01-01 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-01 00:01:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("2022-01-02 00:00:00")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("2022-01-01 00:20:00")])])])]),t._v(" "),s("p",[t._v("Customers 表代表顾客信息，cust_id 为顾客 id，cust_email 为顾客 email")]),t._v(" "),s("p",[t._v("【问题】返回购买 prod_id 为 BR01 的产品的所有顾客的电子邮件（Customers 表中的 cust_email），结果无需排序。")]),t._v(" "),s("p",[t._v("提示：涉及到 SELECT 语句，最内层的从 OrderItems 表返回 order_num，中间的从 Customers 表返回 cust_id，但是必须使用 INNER JOIN 语法。(我看未必)")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_email\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" cust_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_id\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Orders\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" order_num "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("in")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" order_num\n                                        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n                                        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BR01'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h3",{attrs:{id:"确定最佳顾客的另一种方式-二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#确定最佳顾客的另一种方式-二"}},[t._v("#")]),t._v(" 确定最佳顾客的另一种方式（二）⭐️")]),t._v(" "),s("p",[t._v("OrderItems 表代表订单信息，确定最佳顾客的另一种方式是看他们花了多少钱，OrderItems 表有订单号 order_num 和 item_price 商品售出价格、quantity 商品数量")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("item_price")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("10")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("1100")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("2")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("5")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("1")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("7")]),t._v(" "),s("td",[t._v("5")])])])]),t._v(" "),s("p",[t._v("Orders 表含有字段 order_num 订单号、cust_id 顾客 id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("cust2")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("cust22")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("cust221")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("cust2217")])])])]),t._v(" "),s("p",[t._v("顾客表 Customers 有字段 cust_id 客户 id、cust_name 客户姓名")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("cust22")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("cust221")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("cust2217")]),t._v(" "),s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("【问题】编写 SQL 语句，返回订单总价不小于1000 的客户名称和总额（OrderItems 表中的order_num）。")]),t._v(" "),s("p",[t._v("提示：需要计算总和（item_price 乘以 quantity）。按总额对结果进行排序，请使用 INNER JOIN 语法。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" quantity"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" total_price\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("inner")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" Orders "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("inner")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" OrderItems "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("order_num"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_name\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("having")]),t._v(" total_price "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" total_price\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("p",[t._v("通过 "),s("code",[t._v("using")]),t._v(" 关键字，根据 "),s("code",[t._v("cust_id")]),t._v(" 将 "),s("code",[t._v("Customers")]),t._v(" 表和 "),s("code",[t._v("Orders")]),t._v(" 表连接，根据 "),s("code",[t._v("order_num")]),t._v(" 将 "),s("code",[t._v("Orders")]),t._v(" 表和 "),s("code",[t._v("OrderItems")]),t._v(" 表连接。")]),t._v(" "),s("p",[s("em",[t._v("using 与 on 区别")])]),t._v(" "),s("p",[s("code",[t._v("using")]),t._v(" 和 "),s("code",[t._v("on")]),t._v(" 是在 SQL 中用于连接表的两种不同方式。")]),t._v(" "),s("ol",[s("li",[s("code",[t._v("using")]),t._v("：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("using")]),t._v(" 是一种简化的连接语法，用于连接两个表，并指定连接条件的字段。它适用于连接那些具有相同名称的字段的表。")]),t._v(" "),s("li",[t._v("在使用 "),s("code",[t._v("using")]),t._v(" 进行连接时，只需在连接的表名之间使用 "),s("code",[t._v("using")]),t._v(" 关键字，并在后面紧跟需要进行连接的字段名，这些字段必须在两个表中都存在且名称相同。")]),t._v(" "),s("li",[t._v("例如："),s("code",[t._v("INNER JOIN table2 using(column_name)")]),t._v("。")])]),t._v(" "),s("ol",{attrs:{start:"2"}},[s("li",[s("code",[t._v("on")]),t._v("：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("on")]),t._v(" 是一种更灵活的连接语法，用于连接两个表，并指定连接条件的具体条件。它适用于连接那些具有不同名称或者复杂条件的字段的表。")]),t._v(" "),s("li",[t._v("在使用 "),s("code",[t._v("on")]),t._v(" 进行连接时，需要在 "),s("code",[t._v("on")]),t._v(" 关键字后面写入连接条件，连接条件可以是简单的等值条件，也可以是更复杂的逻辑条件。")]),t._v(" "),s("li",[t._v("例如："),s("code",[t._v("INNER JOIN table2 on table1.column_name = table2.column_name")]),t._v("。")])]),t._v(" "),s("p",[t._v("总结：")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("using")]),t._v(" 适用于连接具有"),s("strong",[t._v("相同名称的字段")]),t._v("的表，它简洁且适用于某些特定场景。")]),t._v(" "),s("li",[s("code",[t._v("on")]),t._v(" 更灵活，适用于连接具有"),s("strong",[t._v("不同名称或复杂条件的字段")]),t._v("的表，它提供了更多的连接方式和条件控制。")])]),t._v(" "),s("h2",{attrs:{id:"创建高级联结"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建高级联结"}},[t._v("#")]),t._v(" 创建高级联结")]),t._v(" "),s("h3",{attrs:{id:"检索每个顾客的名称和所有的订单号-一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索每个顾客的名称和所有的订单号-一"}},[t._v("#")]),t._v(" 检索每个顾客的名称和所有的订单号（一）")]),t._v(" "),s("p",[t._v("Customers 表代表顾客信息含有顾客 id cust_id 和 顾客名称 cust_name")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("cust22")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("cust221")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("cust2217")]),t._v(" "),s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("Orders表代表订单信息含有订单号order_num和顾客id cust_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("cust2")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("cust22")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("cust221")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("cust2217")])])])]),t._v(" "),s("p",[t._v("【问题】使用 INNER JOIN 编写 SQL 语句，检索每个顾客的名称（Customers 表中的 cust_name）和所有的订单号（Orders 表中的 order_num），最后根据顾客姓名 cust_name 升序返回。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("inner")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" Orders "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_name\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"检索每个顾客的名称和所有的订单号-二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#检索每个顾客的名称和所有的订单号-二"}},[t._v("#")]),t._v(" 检索每个顾客的名称和所有的订单号（二）⭐️")]),t._v(" "),s("p",[t._v("Orders 表代表订单信息含有订单号 order_num 和顾客 id：cust_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("order_num")]),t._v(" "),s("th",[t._v("cust_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a1")]),t._v(" "),s("td",[t._v("cust10")])]),t._v(" "),s("tr",[s("td",[t._v("a2")]),t._v(" "),s("td",[t._v("cust1")])]),t._v(" "),s("tr",[s("td",[t._v("a3")]),t._v(" "),s("td",[t._v("cust2")])]),t._v(" "),s("tr",[s("td",[t._v("a4")]),t._v(" "),s("td",[t._v("cust22")])]),t._v(" "),s("tr",[s("td",[t._v("a5")]),t._v(" "),s("td",[t._v("cust221")])]),t._v(" "),s("tr",[s("td",[t._v("a7")]),t._v(" "),s("td",[t._v("cust2217")])])])]),t._v(" "),s("p",[t._v("Customers 表代表顾客信息含有顾客 id cust_id 和顾客名称 cust_name")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_id")]),t._v(" "),s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("cust10")]),t._v(" "),s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("cust1")]),t._v(" "),s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("cust2")]),t._v(" "),s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("cust22")]),t._v(" "),s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("cust221")]),t._v(" "),s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("cust2217")]),t._v(" "),s("td",[t._v("hex")])]),t._v(" "),s("tr",[s("td",[t._v("cust40")]),t._v(" "),s("td",[t._v("ace")])])])]),t._v(" "),s("p",[t._v("【问题】检索每个顾客的名称（Customers 表中的 cust_name）和所有的订单号（Orders 表中的 order_num），"),s("strong",[t._v("列出所有的顾客，即使他们没有下过订单")]),t._v("。最后根据顾客姓名 cust_name 升序返回。")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" Orders "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("cust_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("ol",[s("li",[s("p",[t._v("内联结：inner join。取两列的交集。")])]),t._v(" "),s("li",[s("p",[t._v("外联结：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("left join。左连接，以左边表的列为主，取两列的交集，对于不在右边列存在的名称取 null。")])]),t._v(" "),s("li",[s("p",[t._v("right join。右连接，以右边表的列为主，取两列的交集，对于不在左边列存在的名称取 null。")])])])])]),t._v(" "),s("h3",{attrs:{id:"返回产品名称和与之相关的订单号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回产品名称和与之相关的订单号"}},[t._v("#")]),t._v(" 返回产品名称和与之相关的订单号")]),t._v(" "),s("p",[t._v("Products 表为产品信息表含有字段 prod_id 产品 id、prod_name 产品名称")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("egg")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("sockets")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("coffee")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cola")])]),t._v(" "),s("tr",[s("td",[t._v("a0023")]),t._v(" "),s("td",[t._v("soda")])])])]),t._v(" "),s("p",[t._v("OrderItems 表为订单信息表含有字段 order_num 订单号和产品 id prod_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("a105")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("a1100")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("a200")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("a1121")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("a10")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("a19")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("a5")])])])]),t._v(" "),s("p",[t._v("【问题】使用 OUTER JOIN 联结 Products 表和 OrderItems 表，返回产品名称（prod_name）和与之相关的订单号（order_num）的列表，并按照产品名称升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("order_num\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" OrderItems "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("h3",{attrs:{id:"返回产品名称和每一项产品的总订单数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#返回产品名称和每一项产品的总订单数"}},[t._v("#")]),t._v(" 返回产品名称和每一项产品的总订单数")]),t._v(" "),s("p",[t._v("Products 表为产品信息表含有字段 prod_id 产品 id、prod_name 产品名称")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("prod_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("egg")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("sockets")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("coffee")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("cola")])]),t._v(" "),s("tr",[s("td",[t._v("a0023")]),t._v(" "),s("td",[t._v("soda")])])])]),t._v(" "),s("p",[t._v("OrderItems 表为订单信息表含有字段 order_num 订单号和产品 id prod_id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("order_num")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("a105")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("a1100")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("a200")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("a1121")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("a10")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("a19")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("a5")])])])]),t._v(" "),s("p",[t._v("【问题】使用 OUTER JOIN 联结 Products 表和 OrderItems 表，返回"),s("strong",[t._v("产品名称")]),t._v("（prod_name）和每一项产品的总订单数（不是订单号），并按产品名称升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# select prod_name, count(order_num) as orders")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("o"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" orders\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" OrderItems o "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" prod_name\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" prod_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("使用 COUNT() 聚合函数计算每个产品的总订单数，并将结果作为 total_orders 列的值返回。")])]),t._v(" "),s("li",[s("p",[t._v("有聚合函数就要分组。")])])]),t._v(" "),s("h3",{attrs:{id:"列出供应商及其可供产品的数量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#列出供应商及其可供产品的数量"}},[t._v("#")]),t._v(" 列出供应商及其可供产品的数量")]),t._v(" "),s("p",[t._v("有 Vendors 表含有 vend_id 供应商 id.")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0002")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")])]),t._v(" "),s("tr",[s("td",[t._v("a0010")])])])]),t._v(" "),s("p",[t._v("有 Products 表含有供应商 id 和供应产品 id")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("vend_id")]),t._v(" "),s("th",[t._v("prod_id")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("egg")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("prod_id_iphone")])]),t._v(" "),s("tr",[s("td",[t._v("a00113")]),t._v(" "),s("td",[t._v("prod_id_tea")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("prod_id_vivo phone")])]),t._v(" "),s("tr",[s("td",[t._v("a0010")]),t._v(" "),s("td",[t._v("prod_id_huawei phone")])])])]),t._v(" "),s("p",[t._v("【问题】")]),t._v(" "),s("p",[t._v("列出供应商（Vendors 表中的 vend_id）及其可供产品的数量，包括没有产品的供应商。你需要使用 OUTER JOIN 和 COUNT() 聚合函数来计算 Products 表中每种产品的数量，最后根据 vend_id 升序排序。")]),t._v(" "),s("p",[t._v("注意：vend_id 列会显示在多个表中，因此在每次引用它时都需要完全限定它。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vend_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("count")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("p"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" prod_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Vendors v\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("left")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("join")]),t._v(" Products p "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("using")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("vend_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("group")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vend_id\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" v"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("vend_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("h2",{attrs:{id:"组合查询"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合查询"}},[t._v("#")]),t._v(" 组合查询")]),t._v(" "),s("h3",{attrs:{id:"将两个-select-语句结合起来-一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将两个-select-语句结合起来-一"}},[t._v("#")]),t._v(" 将两个 SELECT 语句结合起来（一）")]),t._v(" "),s("p",[t._v("表 OrderItems 包含订单产品信息，字段 prod_id 代表产品 id、quantity 代表产品数量")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("100")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("5")])]),t._v(" "),s("tr",[s("td",[t._v("BNBG")]),t._v(" "),s("td",[t._v("10002")])])])]),t._v(" "),s("p",[t._v("【问题】将两个 SELECT 语句结合起来，以便从 OrderItems 表中检索产品 id（prod_id）和 quantity。其中，一个 SELECT 语句过滤数量为 100 的行，另一个 SELECT 语句过滤 id 以 BNBG 开头的产品，最后按产品 id 对结果进行升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" quantity\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" quantity "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" quantity\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BNBG%'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("p",[t._v("知识点：")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://cmty256.github.io/pages/ed0fa0/#%E7%BB%84%E5%90%88-union",target:"_blank",rel:"noopener noreferrer"}},[t._v("UNION 组合 | DreamRain (cmty256.github.io)"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"将两个-select-语句结合起来-二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将两个-select-语句结合起来-二"}},[t._v("#")]),t._v(" 将两个 SELECT 语句结合起来（二）")]),t._v(" "),s("p",[t._v("表 OrderItems 包含订单产品信息，字段 prod_id 代表产品 id、quantity 代表产品数量。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0001")]),t._v(" "),s("td",[t._v("105")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("100")])]),t._v(" "),s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("200")])]),t._v(" "),s("tr",[s("td",[t._v("a0013")]),t._v(" "),s("td",[t._v("1121")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("10")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("19")])]),t._v(" "),s("tr",[s("td",[t._v("a0003")]),t._v(" "),s("td",[t._v("5")])]),t._v(" "),s("tr",[s("td",[t._v("BNBG")]),t._v(" "),s("td",[t._v("10002")])])])]),t._v(" "),s("p",[t._v("【问题】将两个 SELECT 语句结合起来，以便从 OrderItems 表中检索产品 id（prod_id）和 quantity。其中，一个 SELECT 语句过滤数量为 100 的行，另一个 SELECT 语句过滤 id 以 BNBG 开头的产品，最后按产品 id 对结果进行升序排序。\n"),s("strong",[t._v("注意：这次仅使用单个 SELECT 语句。")])]),t._v(" "),s("p",[t._v("【示例结果】")]),t._v(" "),s("p",[t._v("返回产品id prod_id 和产品数量 quantity")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_id")]),t._v(" "),s("th",[t._v("quantity")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("a0002")]),t._v(" "),s("td",[t._v("100")])]),t._v(" "),s("tr",[s("td",[t._v("BNBG")]),t._v(" "),s("td",[t._v("10002")])])])]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" quantity\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" OrderItems\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("where")]),t._v(" quantity "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("or")]),t._v(" prod_id "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("like")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'BNBG%'")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("h3",{attrs:{id:"组合-products-表中的产品名称和-customers-表中的顾客名称"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组合-products-表中的产品名称和-customers-表中的顾客名称"}},[t._v("#")]),t._v(" 组合 Products 表中的产品名称和 Customers 表中的顾客名称⭐️")]),t._v(" "),s("p",[t._v("Products 表含有字段 prod_name 代表产品名称")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("prod_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("flower")])]),t._v(" "),s("tr",[s("td",[t._v("rice")])]),t._v(" "),s("tr",[s("td",[t._v("ring")])]),t._v(" "),s("tr",[s("td",[t._v("umbrella")])])])]),t._v(" "),s("p",[t._v("Customers 表代表顾客信息，cust_name 代表顾客名称")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("cust_name")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("andy")])]),t._v(" "),s("tr",[s("td",[t._v("ben")])]),t._v(" "),s("tr",[s("td",[t._v("tony")])]),t._v(" "),s("tr",[s("td",[t._v("tom")])]),t._v(" "),s("tr",[s("td",[t._v("an")])]),t._v(" "),s("tr",[s("td",[t._v("lee")])]),t._v(" "),s("tr",[s("td",[t._v("hex")])])])]),t._v(" "),s("p",[t._v("【问题】")]),t._v(" "),s("p",[t._v("编写 SQL 语句，组合 Products 表中的产品名称（prod_name）和 Customers 表中的顾客名称（cust_name）并返回，然后按产品名称对结果进行升序排序。")]),t._v(" "),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# UNION 结果集中的列名总是等于 UNION 中第一个 SELECT 语句中的列名.")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" prod_name\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Products\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("union")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("select")]),t._v(" cust_name\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" Customers\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("order")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("by")]),t._v(" prod_name\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])]),s("h3",{attrs:{id:"纠错-4"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#纠错-4"}},[t._v("#")]),t._v(" 纠错 4")]),t._v(" "),s("p",[t._v("表 Customers 含有字段 cust_name 顾客名、cust_contact 顾客联系方式、cust_state 顾客州、cust_email 顾客 email")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://uploadfiles.nowcoder.com/images/20220219/393256_1645261550253/F36BDA89E8A58FA742AAFE2284C61EB3",alt:"img"}})]),t._v(" "),s("p",[t._v("【问题】修正下面错误的 SQL")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_contact"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_email \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" cust_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MI'")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNION")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_contact"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_email \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" cust_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IL'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("答案：")]),t._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_contact"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_email \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" cust_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'MI'")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("UNION")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_contact"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" cust_email \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" Customers \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("WHERE")]),t._v(" cust_state "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'IL'")]),t._v(" \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" cust_name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br")])]),s("p",[t._v("错误点：写了两个 "),s("code",[t._v("order by")])]),t._v(" "),s("p",[t._v("知识点：")]),t._v(" "),s("p",[t._v("使用 union 组合查询时，只能使用一条 order by 子句，他必须位于最后一条 select 语句之后，因为对于【结果集】不存在对于一部分数据进行排序，而另一部分用另一种排序规则的情况。")])])}),[],!1,null,null,null);s.default=_.exports}}]);